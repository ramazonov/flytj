<div class="main-block">
  <div class="top-nav__block">
    <span class="close-button" (click)="closeModal()">
      <app-icon icon="arrow-left-icon" color="none"/>
    </span>

    <h3 class="top-nav__block-title">Детали пассажира</h3>

    <span class="edit-button">
      <app-icon icon="edit-icon" color="none"/>
    </span>
  </div>

  <div class="main-content">
    <h3 class="mt-0 mb-2">{{ getAgeCategory(passenger.birthDate) }}</h3>
    <ul class="inputs-list">
      <li class="inputs-list__item">
        <div class="inputs-list__item-block">
          <input
            [(ngModel)]="passenger.firstName"
            placeholder="Имя"
            class="text-field"
            type="text"
          >
        </div>
      </li>
      <li class="inputs-list__item">
        <div class="inputs-list__item-block">
          <input
            [(ngModel)]="passenger.surName"
            placeholder="Фамилия"
            class="text-field"
            type="text"
          >
        </div>
      </li>
      <li class="inputs-list__item">
        <div class="inputs-list__item-block">
          <input
            [(ngModel)]="passenger.middleName"
            placeholder="Отчество"
            class="text-field"
            name="middleName"
            type="text"
          >
        </div>
      </li>
      <li class="inputs-list__item">
        <div class="inputs-list__item-block">
          <span class="date-icon">
             <app-icon icon="calendar-inactive-icon" color="none"/>
          </span>
          <input
            [(ngModel)]="passenger.birthDate"
            type="text"
            placeholder="Дата рождения"
            name="birthDate"
            class="text-field"
            inputmode="numeric"
            pattern="[0-9]*"
          >
        </div>
      </li>
      <li class="inputs-list__item">
        <div class="selector-block" (click)="toggleGenderDropdown()">
          <span class="selected-passport" *ngIf="passenger.gender">
            {{ getGenderText(passenger.gender) }}
          </span>
          <span *ngIf="!passenger.gender" class="selected-passport">
            Выберите пол
          </span>

          <div class="dropdown" *ngIf="isGenderDropdownOpen" (click)="$event.stopPropagation()">
            <ul class="gender-list">
              <li
                class="gender-list__item"
                *ngFor="let gender of genders"
                (click)="selectGender(gender.value)"
              >
                {{ gender.text }}
              </li>
            </ul>
          </div>
        </div>
      </li>
      <li class="inputs-list__item">
        <div class="inputs-list__item-block">
          <input
            [(ngModel)]="passenger.email"
            placeholder="Email"
            class="text-field"
            name="email"
            type="email"
          >
        </div>
      </li>
      <li class="inputs-list__item">
        <div class="inputs-list__item-block">
          <input
            [(ngModel)]="passenger.phone"
            placeholder="Телефон"
            class="text-field"
            name="phone"
            type="text"
          >
        </div>
      </li>
    </ul>

    <h3 class="mt-3 mb-3">Паспорт</h3>

    <ul class="inputs-list">
      <li class="inputs-list__item">
        <div class="selector-block" (click)="toggleCitizenship()">
          <!-- Отображение выбранной страны -->
          <span class="selected-passport" *ngIf="passenger.citizenShip">
            {{ getCitizenshipText(passenger.citizenShip) }}
          </span>
          <span *ngIf="!passenger.gender" class="selected-passport">
            Выберите страну
          </span>

          <!-- Выпадающий список -->
          <div
            class="dropdown"
            *ngIf="isCitizenshipDropdownOpen"
            (click)="$event.stopPropagation()"
          >
            <ul class="gender-list">
              <li
                class="gender-list__item"
                *ngFor="let country of countries"
                (click)="selectCountry(country.code)"
              >
                {{ country.name }}
              </li>
            </ul>
          </div>
        </div>
      </li>
      <li class="inputs-list__item">
        <div class="selector-block" (click)="togglePassportDropdown()">
          <!-- Отображение выбранного документа -->
          <span class="selected-passport" *ngIf="passenger.documentType">
            {{ getPassportText(passenger.documentType) }}
          </span>
          <span *ngIf="!passenger.gender" class="selected-passport">
            Выберите тип документа
          </span>

          <!-- Выпадающий список -->
          <div class="dropdown" *ngIf="isPassportDropdownOpen" (click)="$event.stopPropagation()">
            <ul class="gender-list">
              <li
                class="gender-list__item"
                *ngFor="let passport of passports"
                (click)="selectPassport(passport.value)"
              >
                {{ passport.text }}
              </li>
            </ul>
          </div>
        </div>
      </li>
      <li class="inputs-list__item">
        <div class="inputs-list__item-block">
          <span class="date-icon">
            <app-icon icon="calendar-inactive-icon" color="none"/>
          </span>
          <input
            [(ngModel)]="passenger.passportIssueDate"
            type="text"
            placeholder="Дата выдачи документа"
            name="passportIssueDate"
            class="text-field"
            inputmode="numeric"
            pattern="[0-9]*"
          >
        </div>
      </li>
      <li class="inputs-list__item">
        <div class="inputs-list__item-block">
          <input
            [(ngModel)]="passenger.documentNumber"
            type="text"
            placeholder="Серия и номер документа"
            class="text-field"
            name="document-number"
          >
        </div>
      </li>
      <li class="inputs-list__item">
        <div class="inputs-list__item-block">
          <span class="date-icon">
            <app-icon icon="calendar-inactive-icon" color="none"/>
          </span>
          <input
            [(ngModel)]="passenger.expirationDate"
            type="text"
            placeholder="Срок действия"
            class="text-field"
            inputmode="numeric"
            name="expiration-date-document"
            pattern="[0-9]*"
          >
        </div>
      </li>
    </ul>

    <button
      class="d-flex align-center justify-center gap-2 btn-primary mt-4"
      (click)="saveChanges()"
    >
      Сохранить
    </button>
    <button
      class="d-flex align-center justify-center gap-2 btn-error mt-4"
      (click)="deletePassenger(passenger.id)"
    >
      <span>Удалить</span>
      <app-icon icon="delete-icon" color="none"/>
    </button>
  </div>

  <div class="loader-overlay" *ngIf="isPassengerEditingLoading">
    <div class="loader"></div>
  </div>
</div>
